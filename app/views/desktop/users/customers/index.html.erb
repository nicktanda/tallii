<div class="flex w-full">
  <div class="w-full space-y-4">
    <div class="font-bold text-lg">Customers</div>
    <div class="flex rounded-lg w-full bg-white">
      <div class="border-2 border-gray-300 w-full border-r-0 rounded-l-lg p-4">
        <div>Number of customers</div>
        <div class="mt-2 text-2xl font-bold"><%= current_organisation.users.count %></div>
      </div>
      <div class="border-2 border-gray-300 w-full p-4">
        <div>New customers this week</div>
        <div class="mt-2 text-2xl font-bold"><%= current_organisation.users.count {|user| user.created_at >= 1.week.ago} %></div>
      </div>
      <div class="border-2 border-gray-300 w-full border-l-0 rounded-r-lg p-4">
        <div>New customers this month</div>
        <div class="mt-2 text-2xl font-bold"><%= current_organisation.users.count {|user| user.created_at >= 1.month.ago} %></div>
      </div>
    </div>
    <%= form_with url: desktop_users_path, method: :get do |f| %>
      <div class="relative">
        <%= f.text_field :phone, placeholder: "Search customer by phone", value: params[:phone], class: "p-4 pl-12 w-full rounded-lg" %>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="absolute top-1/2 left-4 transform -translate-y-1/2 w-6 h-6 text-gray-500">
          <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
        </svg>
      </div>
    <% end %>
    <div class="bg-white rounded-lg border-gray-300 border-2">
      <div class="flex space-x-2 p-4">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 14.25v2.25m3-4.5v4.5m3-6.75v6.75m3-9v9M6 20.25h12A2.25 2.25 0 0 0 20.25 18V6A2.25 2.25 0 0 0 18 3.75H6A2.25 2.25 0 0 0 3.75 6v12A2.25 2.25 0 0 0 6 20.25Z" />
        </svg>
        <div class="font-bold">Customer List</div>
      </div>
      <table class="w-full bg-gray-100">
        <thead>
          <tr>
            <th class="border-2 px-4 py-2">Customer</th>
            <th class="border-2 px-4 py-2">Phone</th>
            <th class="border-2 px-4 py-2">Pet Names</th>
            <th class="border-2 px-4 py-2">Services Used</th>
          </tr>
        </thead>
        <tbody>
          <% ('A'..'Z').each do |letter| %>
            <% if @users.any? {|user| user.role == "customer" && user.first_name[0] == letter } %>
              <tr>
                <td class="font-bold text-lg p-4"><%= letter %></td>
              </tr>
              <% @users.select {|user| user.role == "customer" && user.first_name[0] == letter }.each do |user| %>
                <tr>
                  <td class="bg-white p-4"><%= user.full_name %></td>
                  <td class="bg-white p-4"><%= user.phone %></td>
                  <td class="bg-white p-4 text-blue-400">
                    <div class="flex">
                      <% user.pets.each_with_index do |pet, index| %>
                        <%= link_to pet.name, desktop_pets_path(pet) %>
                        <% if user.pets.size > 1 && index != user.pets.size - 1 %>
                          <div class="text-blue-400">,</div>
                        <% end %>
                      <% end %>
                    </div>
                  </td>
                  <td class="bg-white p-4">
                    <div class="flex space-x-2">
                      <% if user.pets.any? {|pet| pet.grooms.any? } %>
                        <div class="p-2 bg-blue-500 text-blue-900 rounded-lg">Grooming</div>
                      <% end %>
                      <% if user.pets.any? {|pet| pet.daycare_visits.any? } %>
                        <div class="p-2 bg-red-500 text-red-900 rounded-lg">Daycare</div>
                      <% end %>
                    </div>
                  </td>
                </tr>
              <% end %>
            <% end %>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
  <div class="w-1/3 p-4">
    
  </div>
</div>