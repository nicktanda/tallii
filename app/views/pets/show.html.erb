<div class="m-1 space-y-2">
  <% if @pet.images.any? %>
    <div class="relative">
      <img src="<%= url_for(@pet.images.order(:created_at).last.image) %>" alt="<%= @pet.name %>" class="rounded-2xl max-h-80 w-full flex flex-col justify-end">
      <%= link_to settings_path do %>
        <div class="absolute top-1 left-1 text-white bg-black rounded-full p-1">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 0 1 1.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.559.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.894.149c-.424.07-.764.383-.929.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 0 1-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.398.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 0 1-.12-1.45l.527-.737c.25-.35.272-.806.108-1.204-.165-.397-.506-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.108-1.204l-.526-.738a1.125 1.125 0 0 1 .12-1.45l.773-.773a1.125 1.125 0 0 1 1.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894Z" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
          </svg>
        </div>
      <% end %>
      <div class="absolute bottom-0 left-0 right-0">
        <div class="flex justify-between">
          <div class="text-white font-bold text-5xl bg-black rounded-2xl p-3"><%= @pet.name %></div>
          <div class="text-white bg-blue-500 font-bold text-xl rounded-2xl p-3"><%= @pet.age %> YO</div>
        </div>
      </div>
    </div>
  <% else %>
    <div class="bg-green-500 rounded-2xl h-80 flex flex-col justify-end">
      <%= link_to settings_path do %>
        <div class="absolute top-1 left-1 text-white bg-black rounded-full p-1">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 0 1 1.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.559.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.894.149c-.424.07-.764.383-.929.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 0 1-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.398.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 0 1-.12-1.45l.527-.737c.25-.35.272-.806.108-1.204-.165-.397-.506-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.108-1.204l-.526-.738a1.125 1.125 0 0 1 .12-1.45l.773-.773a1.125 1.125 0 0 1 1.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894Z" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
          </svg>
        </div>
      <% end %>
      <div class="flex justify-between">
        <div class="text-white font-bold text-5xl p-2"><%= @pet.name %></div>
        <div class="text-white bg-blue-500 font-bold text-xl rounded-2xl p-3"><%= @pet.age %> YO</div>
      </div>
    </div>
  <% end %>
  <div class="flex my-2 space-x-2">
    <%= link_to daycare_visits_path, class: "w-1/2 bg-red-500 rounded-2xl flex p-2 space-x-2" do %>
      <div class="w-1/2 flex space-x-2">
        <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 bg-black text-white rounded-lg">
          <path d="M17.8125 3.75002C16.3971 3.74695 15.0038 4.10074 13.7614 4.77869C12.5189 5.45663 11.4674 6.43685 10.7041 7.62874C9.94072 8.82062 9.49015 10.1857 9.39402 11.5978C9.29789 13.0099 9.55929 14.4235 10.1541 15.7078L1.875 23.986L3.20063 25.3125L11.1572 17.356C11.5892 17.9114 12.0886 18.4109 12.6441 18.8428L9.375 22.1119L10.7006 23.4375L14.2922 19.846C15.4377 20.3728 16.6868 20.6361 17.9475 20.6165C19.2082 20.5969 20.4484 20.2948 21.577 19.7326C22.7056 19.1704 23.6937 18.3622 24.4687 17.3677C25.2437 16.3731 25.7859 15.2175 26.0553 13.9857C26.3246 12.754 26.3144 11.4775 26.0254 10.2502C25.7363 9.02293 25.1757 7.87609 24.3849 6.89406C23.5941 5.91204 22.5931 5.11983 21.4557 4.57572C20.3183 4.03161 19.0734 3.74946 17.8125 3.75002ZM24.2869 11.1619C22.9204 10.9436 21.6578 10.2992 20.6794 9.32067C19.7009 8.34218 19.0565 7.07961 18.8381 5.71314C20.2046 5.93148 21.4672 6.57588 22.4456 7.55437C23.4241 8.53286 24.0685 9.79543 24.2869 11.1619V11.1619ZM11.3381 13.2131C12.7046 13.4315 13.9672 14.0759 14.9457 15.0544C15.9241 16.0329 16.5685 17.2954 16.7869 18.6619C15.4204 18.4436 14.1578 17.7992 13.1793 16.8207C12.2009 15.8422 11.5565 14.5796 11.3381 13.2131ZM18.6844 18.6853C18.4573 16.8095 17.6079 15.064 16.2719 13.7278C14.9359 12.3916 13.1905 11.542 11.3147 11.3147C11.5077 9.8908 12.1624 8.5695 13.1784 7.55344C14.1945 6.53738 15.5158 5.88267 16.9397 5.68971C17.1667 7.56553 18.0161 9.31107 19.3521 10.6472C20.6881 11.9834 22.4336 12.8331 24.3094 13.0603C24.1164 14.4842 23.4617 15.8055 22.4456 16.8216C21.4296 17.8377 20.1083 18.4924 18.6844 18.6853V18.6853Z" fill="white"/>
        </svg>
        <div>
          <div class="font-bold">Daycare</div>
          <div>Visits Left:</div>
        </div>
      </div>
      <div class="w-1/2 text-7xl align-text-bottom font-bold"><%= @pet.visits_remaining %></div>
    <% end %>
    <%= link_to grooms_path, class: "w-1/2 bg-lime-100 rounded-2xl flex p-2 space-x-2" do %>
      <div class="flex space-x-2">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 bg-black text-white rounded-lg">
          <path stroke-linecap="round" stroke-linejoin="round" d="m7.848 8.25 1.536.887M7.848 8.25a3 3 0 1 1-5.196-3 3 3 0 0 1 5.196 3Zm1.536.887a2.165 2.165 0 0 1 1.083 1.839c.005.351.054.695.14 1.024M9.384 9.137l2.077 1.199M7.848 15.75l1.536-.887m-1.536.887a3 3 0 1 1-5.196 3 3 3 0 0 1 5.196-3Zm1.536-.887a2.165 2.165 0 0 0 1.083-1.838c.005-.352.054-.695.14-1.025m-1.223 2.863 2.077-1.199m0-3.328a4.323 4.323 0 0 1 2.068-1.379l5.325-1.628a4.5 4.5 0 0 1 2.48-.044l.803.215-7.794 4.5m-2.882-1.664A4.33 4.33 0 0 0 10.607 12m3.736 0 7.794 4.5-.802.215a4.5 4.5 0 0 1-2.48-.043l-5.326-1.629a4.324 4.324 0 0 1-2.068-1.379M14.343 12l-2.882 1.664" />
        </svg>
        <div>
          <div class="font-bold">Next Groom</div>
          <div class="text-2xl font-bold"><%= @pet.next_groom || "-" %></div>
        </div>
      </div>
    <% end %>
  </div>
  <div class="bg-violet-400 rounded-2xl relative" onclick="openDaycareVisitModal()">
    <div class="absolute top-0 right-0 flex">
      <div class="w-0 h-0" style="border-top: 32px solid black; border-left: 32px solid transparent;"></div>
      <div class="h-8 w-32 bg-black"></div>
    </div>
    <div class="p-2 flex space-x-2 h-28">
      <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 bg-black text-white rounded-lg p-1">
        <path d="M17.8125 3.75002C16.3971 3.74695 15.0038 4.10074 13.7614 4.77869C12.5189 5.45663 11.4674 6.43685 10.7041 7.62874C9.94072 8.82062 9.49015 10.1857 9.39402 11.5978C9.29789 13.0099 9.55929 14.4235 10.1541 15.7078L1.875 23.986L3.20063 25.3125L11.1572 17.356C11.5892 17.9114 12.0886 18.4109 12.6441 18.8428L9.375 22.1119L10.7006 23.4375L14.2922 19.846C15.4377 20.3728 16.6868 20.6361 17.9475 20.6165C19.2082 20.5969 20.4484 20.2948 21.577 19.7326C22.7056 19.1704 23.6937 18.3622 24.4687 17.3677C25.2437 16.3731 25.7859 15.2175 26.0553 13.9857C26.3246 12.754 26.3144 11.4775 26.0254 10.2502C25.7363 9.02293 25.1757 7.87609 24.3849 6.89406C23.5941 5.91204 22.5931 5.11983 21.4557 4.57572C20.3183 4.03161 19.0734 3.74946 17.8125 3.75002ZM24.2869 11.1619C22.9204 10.9436 21.6578 10.2992 20.6794 9.32067C19.7009 8.34218 19.0565 7.07961 18.8381 5.71314C20.2046 5.93148 21.4672 6.57588 22.4456 7.55437C23.4241 8.53286 24.0685 9.79543 24.2869 11.1619V11.1619ZM11.3381 13.2131C12.7046 13.4315 13.9672 14.0759 14.9457 15.0544C15.9241 16.0329 16.5685 17.2954 16.7869 18.6619C15.4204 18.4436 14.1578 17.7992 13.1793 16.8207C12.2009 15.8422 11.5565 14.5796 11.3381 13.2131ZM18.6844 18.6853C18.4573 16.8095 17.6079 15.064 16.2719 13.7278C14.9359 12.3916 13.1905 11.542 11.3147 11.3147C11.5077 9.8908 12.1624 8.5695 13.1784 7.55344C14.1945 6.53738 15.5158 5.88267 16.9397 5.68971C17.1667 7.56553 18.0161 9.31107 19.3521 10.6472C20.6881 11.9834 22.4336 12.8331 24.3094 13.0603C24.1164 14.4842 23.4617 15.8055 22.4456 16.8216C21.4296 17.8377 20.1083 18.4924 18.6844 18.6853V18.6853Z" fill="white"/>
      </svg>
      <div>
        <div class="flex items-center space-x-2">
          <div class="text-xl font-bold">Daycare</div>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-4 w-4 text-black">
            <path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd" />
          </svg>
        </div>
        <div>History</div>
      </div>
    </div>
    <div class="flex flex-col justify-end">
      <div class="bg-white rounded-b-2xl flex justify-between p-2">
        <div>Last daycare visit was:</div>
        <div class="font-bold"><%= @pet.last_daycare_visit || "-" %></div>
      </div>
    </div>
  </div>
  <div class="bg-yellow-200 rounded-2xl relative" onclick="openGroomModal()">
    <div class="absolute top-0 right-0 flex">
      <div class="w-0 h-0" style="border-top: 32px solid black; border-left: 32px solid transparent;"></div>
      <div class="h-8 w-32 bg-black"></div>
    </div>
    <div class="p-2 flex space-x-2 h-28">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12 bg-black text-white rounded-lg p-1">
        <path stroke-linecap="round" stroke-linejoin="round" d="m7.848 8.25 1.536.887M7.848 8.25a3 3 0 1 1-5.196-3 3 3 0 0 1 5.196 3Zm1.536.887a2.165 2.165 0 0 1 1.083 1.839c.005.351.054.695.14 1.024M9.384 9.137l2.077 1.199M7.848 15.75l1.536-.887m-1.536.887a3 3 0 1 1-5.196 3 3 3 0 0 1 5.196-3Zm1.536-.887a2.165 2.165 0 0 0 1.083-1.838c.005-.352.054-.695.14-1.025m-1.223 2.863 2.077-1.199m0-3.328a4.323 4.323 0 0 1 2.068-1.379l5.325-1.628a4.5 4.5 0 0 1 2.48-.044l.803.215-7.794 4.5m-2.882-1.664A4.33 4.33 0 0 0 10.607 12m3.736 0 7.794 4.5-.802.215a4.5 4.5 0 0 1-2.48-.043l-5.326-1.629a4.324 4.324 0 0 1-2.068-1.379M14.343 12l-2.882 1.664" />
      </svg>
      <div>
        <div class="flex items-center space-x-2">
          <div class="text-xl font-bold">Grooming</div>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-4 w-4 text-black">
            <path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd" />
          </svg>
        </div>
        <div>History</div>
      </div>
    </div>
    <div class="flex flex-col justify-end">
      <div class="bg-white rounded-b-2xl flex justify-between p-2">
        <div>Last groom visit was:</div>
        <div class="font-bold"><%= @pet.last_groom || "-" %></div>
      </div>
    </div>
  </div>
  <div class="relative" onclick="openPhotoModal()">
    <div class="bg-black w-full h-6"></div>
    <div class="absolute top-0 right-24 rounded-t-2xl">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="rounded-full h-12 w-12 border-4 border-black bg-teal-200 p-2">
        <path d="M12 9a3.75 3.75 0 1 0 0 7.5A3.75 3.75 0 0 0 12 9Z" />
        <path fill-rule="evenodd" d="M9.344 3.071a49.52 49.52 0 0 1 5.312 0c.967.052 1.83.585 2.332 1.39l.821 1.317c.24.383.645.643 1.11.71.386.054.77.113 1.152.177 1.432.239 2.429 1.493 2.429 2.909V18a3 3 0 0 1-3 3h-15a3 3 0 0 1-3-3V9.574c0-1.416.997-2.67 2.429-2.909.382-.064.766-.123 1.151-.178a1.56 1.56 0 0 0 1.11-.71l.822-1.315a2.942 2.942 0 0 1 2.332-1.39ZM6.75 12.75a5.25 5.25 0 1 1 10.5 0 5.25 5.25 0 0 1-10.5 0Zm12-1.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z" clip-rule="evenodd" />
      </svg>
    </div>
    <div class="bg-teal-200 rounded-2xl">
      <div class="p-2 h-28">
        <div class="text-xl font-bold">Pictures of <%= @pet.name %></div>
        <div>Pictures of <%= @pet.name %>'s visits can be found here</div>
      </div>
      <div class="flex flex-col justify-end">
        <div class="bg-white rounded-b-2xl flex justify-between p-2">
          <div>Last added picture:</div>
          <div class="font-bold"><%= last_uploaded_image_date(@pet) || "-" %></div>
        </div>
      </div>
    </div>
  </div>
</div>
<div id="overlay" class="fixed top-0 left-0 w-screen h-screen bg-gray-900 bg-opacity-75 backdrop-blur-sm hidden" onclick="closeModals()"></div>
<div id="daycareVisitModal" class="fixed bottom-0 left-0 w-full bg-white overflow-hidden transition-all duration-500 z-20 rounded-t-xl" style="height: 0;">
  <div class="flex justify-between p-4">
    <div class="absolute top-0 right-6 text-black text-4xl cursor-pointer" onclick="closeModals()">&times;</div>
  </div>
  <div class="text-center font-bold">Daycare History</div>
  <div class="text-center mb-2">Last daycare visit was: <b><%= @pet.last_daycare_visit || "-" %></b></div>
  
  <div class="bg-violet-400 overflow-y-scroll max-h-[60vh]">
    <% @pet.daycare_visits.each_with_index do |daycare_visit, index| %>
      <div class="space-y-2 p-4 <%= index.even? ? 'bg-violet-400' : 'bg-violet-500' %>">
        <div><b>Date: </b><%= daycare_visit.date.strftime("%B %d, %Y") %></div>
        <div><b>Duration: </b><%= daycare_visit.formatted_duration %></div>
        <div class="font-bold">Notes:</div>
        <div><%= daycare_visit.notes %></div>
      </div>
    <% end %>
  </div>
</div>
<div id="groomModal" class="fixed bottom-0 left-0 w-full bg-white overflow-hidden transition-all duration-500 z-20 rounded-t-xl" style="height: 0;">
  <div class="flex justify-between p-4">
    <div class="absolute top-0 right-6 text-black text-4xl cursor-pointer" onclick="closeModals()">&times;</div>
  </div>
  <div class="text-center font-bold">Grooming History</div>
  <div class="text-center mb-2">Last groom was: <b><%= @pet.last_groom || "-" %></b></div>
  
  <div class="bg-yellow-200 overflow-y-scroll max-h-[60vh]">
    <% @pet.grooms.each_with_index do |groom, index| %>
      <div class="space-y-2 p-4 <%= index.even? ? 'bg-yellow-200' : 'bg-yellow-300' %>">
        <div><b>Date: </b><%= groom.date.strftime("%B %d, %Y") %></div>
        <div><b>Duration: </b><%= groom.user&.first_name %></div>
        <div class="font-bold">Notes:</div>
        <div><%= groom.notes %></div>
      </div>
    <% end %>
  </div>
</div>
<div id="photoModal" class="fixed bottom-0 left-0 w-full bg-white overflow-hidden transition-all duration-500 z-20 rounded-t-xl" style="height: 0;">
  <div class="flex justify-between p-4">
    <div class="absolute top-0 right-6 text-black text-4xl cursor-pointer" onclick="closeModals()">&times;</div>
  </div>
  <div class="text-center font-bold">Photo Gallery</div>
  <div class="text-center mb-2">Here are your photos from <%= @pet.name %>'s previous visits</b></div>
  
  <div class="bg-teal-200 overflow-y-scroll max-h-[60vh]">
    <% @pet.grooms.flat_map(&:images).each_with_index do |image, index| %>
      <div class="space-y-2 p-4 <%= index.even? ? 'bg-teal-200' : 'bg-teal-300' %>">
        <div><b>Uploaded at:</b> <%= image.created_at.strftime("%B %d, %Y") %></div>
        <img src="<%= url_for(image.image) %>" alt="<%= @pet.name %>" class="rounded-2xl max-h-80 w-full flex flex-col justify-end">
      </div>
    <% end %>
  </div>
</div>

<script>
  function openDaycareVisitModal() {
    const sidenav = document.getElementById("daycareVisitModal");
    document.getElementById("overlay").classList.remove("hidden");
    sidenav.style.height = "auto";
    const height = sidenav.scrollHeight + "px"; 
    sidenav.style.height = "0";
    requestAnimationFrame(() => {
      sidenav.style.height = height;
    });
    sidenav.style.transition = "height 0.5s ease"; 
  }
  
  function openGroomModal() {
    const sidenav = document.getElementById("groomModal");
    document.getElementById("overlay").classList.remove("hidden");
    sidenav.style.height = "auto";
    const height = sidenav.scrollHeight + "px"; 
    sidenav.style.height = "0";
    requestAnimationFrame(() => {
      sidenav.style.height = height;
    });
    sidenav.style.transition = "height 0.5s ease"; 
  }

  function openPhotoModal() {
    const sidenav = document.getElementById("photoModal");
    document.getElementById("overlay").classList.remove("hidden");
    sidenav.style.height = "auto";
    const height = sidenav.scrollHeight + "px"; 
    sidenav.style.height = "0";
    requestAnimationFrame(() => {
      sidenav.style.height = height;
    });
    sidenav.style.transition = "height 0.5s ease"; 
  }

  function closeModals() {
    document.getElementById("overlay").classList.add("hidden");
    document.getElementById("daycareVisitModal").style.height = "0";
    document.getElementById("groomModal").style.height = "0";
    document.getElementById("photoModal").style.height = "0";
  }
</script>

